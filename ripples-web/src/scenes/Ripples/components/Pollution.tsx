import React, { Component } from 'react'
import { Circle, Marker, GeoJSON, Polygon } from 'react-leaflet'
import { connect } from 'react-redux'
import IPollution from '../../../model/IPollution'
import * as L from 'leaflet'
import { setSidePanelContent, setSidePanelTitle, setSidePanelVisibility } from '../../../redux/ripples.actions'
import { BlueCircleIcon, GreenCircleIcon, YellowCircleIcon, OrangeCircleIcon, RedCircleIcon } from './Icons'
import { LatLng } from 'leaflet'
import IObstacle from '../../../model/IObstacles'

interface PropsType {
  locationSelected?: {
    latitude: any
    longitude: any
  }
  pollutionMarkers?: IPollution[]
  pollutionOpen: IPollution[]
  obstaclePolygons?: IObstacle[]
  obstacleLocationSelected: {
    latitude: any
    longitude: any
  }[]

  addCircle: (pollution: IPollution) => void
  removeCircle: (pollution: IPollution) => void
  setObstacle: (obstacle: IObstacle) => void
  setSidePanelTitle: (title: string) => void
  setSidePanelContent: (content: any) => void
  setSidePanelVisibility: (v: boolean) => void
}

class Pollution extends Component<PropsType, {}> {
  constructor(props: PropsType) {
    super(props)
    this.onObstacleClick = this.onObstacleClick.bind(this)
  }

  public buildPollutionMarkers() {
    if (this.props.pollutionMarkers) {
      return this.props.pollutionMarkers.map((p, index) => {
        const point = new L.LatLng(p.latitude, p.longitude)
        let color = ''
        let icon: L.Icon
        switch (p.status) {
          case 'Synched':
            color = 'yellow'
            icon = new YellowCircleIcon()
            break
          case 'Exec':
            color = 'orange'
            icon = new OrangeCircleIcon()
            break
          case 'Done':
            color = 'green'
            icon = new GreenCircleIcon()
            break
          default:
            color = 'red'
            icon = new RedCircleIcon()
            break
        }
        if (this.props.pollutionOpen.includes(p)) {
          return (
            <Circle
              key={'pollutionCircle_' + index}
              center={[point.lat, point.lng]}
              fillColor={color}
              color={color}
              radius={p.radius}
              onclick={() => this.props.removeCircle(p)}
            />
          )
        } else {
          return (
            <Marker
              key={'pollutionMarker_' + index}
              position={[point.lat, point.lng]}
              icon={icon}
              onClick={() => this.props.addCircle(p)}
            />
          )
        }
      })
    }
  }

  public buildSelectedLocation() {
    if (this.props.locationSelected) {
      return (
        <Marker
          position={[this.props.locationSelected.latitude, this.props.locationSelected.longitude]}
          icon={new BlueCircleIcon()}
        />
      )
    }
  }

  public buildObstaclesPolygons() {
    if (this.props.obstaclePolygons) {
      return this.props.obstaclePolygons.map((obstacle, index) => {
        const positions: L.LatLng[] = []
        obstacle.positions.forEach((pos) => {
          const obstaclePosition: L.LatLng = new LatLng(pos[0], pos[1])
          positions.push(obstaclePosition)
        })

        return (
          <Polygon
            key={'obstaclePolygon_' + index}
            positions={positions}
            color="black"
            onClick={(e: any) => this.onObstacleClick(e, obstacle)}
          />
        )
      })
    }
  }

  public onObstacleClick(evt: any, obstacle: IObstacle) {
    evt.originalEvent.view.L.DomEvent.stopPropagation(evt)
    this.props.setSidePanelTitle(obstacle.description)
    this.props.setSidePanelVisibility(true)
    this.props.setObstacle(obstacle)
  }

  public drawObstacleLocation() {
    if (this.props.obstacleLocationSelected) {
      const positions: L.LatLng[] = []
      this.props.obstacleLocationSelected.forEach((obstacle) => {
        const pos: L.LatLng = new LatLng(obstacle.latitude, obstacle.longitude)
        positions.push(pos)
      })

      return <Polygon positions={positions} color="red" />
    }
  }

  public buildAveiroArea() {
    const geojsonFeature: any = {
      type: 'FeatureCollection',
      name: 'aveiro',
      crs: { type: 'name', properties: { name: 'urn:ogc:def:crs:OGC:1.3:CRS84' } },
      features: [
        {
          type: 'Feature',
          properties: { id: 0, INDEXKEY: null },
          geometry: {
            type: 'Polygon',
            coordinates: [
              [
                [-8.801843105266867, 40.484976114893961],
                [-8.800663754912224, 40.484982932854528],
                [-8.799484404154846, 40.484989738782119],
                [-8.798305052995472, 40.484996532676703],
                [-8.79712570143484, 40.485003314538318],
                [-8.795946349473612, 40.485010084366891],
                [-8.794793527068553, 40.48771829355271],
                [-8.793649442844265, 40.491326974002483],
                [-8.792505238489714, 40.494935641844116],
                [-8.791360913972536, 40.498544297073245],
                [-8.790216469260312, 40.502152939685473],
                [-8.789063131488096, 40.504861087805956],
                [-8.789071904320679, 40.50576156967648],
                [-8.787927219121167, 40.509370187041874],
                [-8.786782413629393, 40.512978791777343],
                [-8.785637487812906, 40.516587383878488],
                [-8.784483725612054, 40.519295482903821],
                [-8.783329871844153, 40.522003569862228],
                [-8.782184613298725, 40.525612124753351],
                [-8.782193300498662, 40.526512604614076],
                [-8.782201988090851, 40.527413084332423],
                [-8.782210676075293, 40.528313563908462],
                [-8.782219364452009, 40.529214043342201],
                [-8.78107392855908, 40.532822584142636],
                [-8.779928372168365, 40.536431112286259],
                [-8.778774049567545, 40.539139149415732],
                [-8.777619635279958, 40.541847174459214],
                [-8.7776282663269, 40.542747652593555],
                [-8.776482362496413, 40.546356143101761],
                [-8.776490979684556, 40.547256620732469],
                [-8.776499597261873, 40.548157098220877],
                [-8.77535354430047, 40.551765575331828],
                [-8.774190192935771, 40.553573086092022],
                [-8.774198781610623, 40.554473562999057],
                [-8.77420737067335, 40.555374039763798],
                [-8.77421596012398, 40.556274516386232],
                [-8.773069651532568, 40.559882967772445],
                [-8.771923222204984, 40.563491406470568],
                [-8.770776672108637, 40.56709983247616],
                [-8.769621468857059, 40.569807770613984],
                [-8.769630001211002, 40.570708245784942],
                [-8.768483209479495, 40.574316646392482],
                [-8.768491727930423, 40.575217121057406],
                [-8.768500246766118, 40.576117595580016],
                [-8.767353305579963, 40.579725982753757],
                [-8.766189263384566, 40.581533409486369],
                [-8.76504210895601, 40.585141771963912],
                [-8.763886372702167, 40.587849648374039],
                [-8.762738990627421, 40.591457985775264],
                [-8.761591487528699, 40.595066310449347],
                [-8.760435445853416, 40.597774149998415],
                [-8.759287714939349, 40.601382449571609],
                [-8.759296118128756, 40.602282921598551],
                [-8.75930452169777, 40.603183393483214],
                [-8.760502796660923, 40.604977925162437],
                [-8.761701136181808, 40.606772443377331],
                [-8.762899540268281, 40.608566948125528],
                [-8.761751764974893, 40.612175265848961],
                [-8.758223768499347, 40.613995446602829],
                [-8.755868876996542, 40.614908684182808],
                [-8.754695579792021, 40.615815520421194],
                [-8.754703925604931, 40.616715990978427],
                [-8.754712271794906, 40.617616461393389],
                [-8.754720618361967, 40.618516931666107],
                [-8.753572238463988, 40.622125166390887],
                [-8.748836886219495, 40.621249994999722],
                [-8.748828617855201, 40.620349524153745],
                [-8.747613871515714, 40.616753932753909],
                [-8.747605620882249, 40.61585346099789],
                [-8.747597370621541, 40.614952989099656],
                [-8.747589120733524, 40.614052517059193],
                [-8.74758087121824, 40.613152044876465],
                [-8.748729426614977, 40.609543862907472],
                [-8.748721163105326, 40.608643390212414],
                [-8.747506642348846, 40.605047788831726],
                [-8.748655068465347, 40.601439603531553],
                [-8.748646808314721, 40.600539129556381],
                [-8.749795098860869, 40.596930931119658],
                [-8.750959846318798, 40.595123669207432],
                [-8.75095155708752, 40.594223194635255],
                [-8.750943268230657, 40.59332271992092],
                [-8.750934979748211, 40.59242224506427],
                [-8.750926691640149, 40.591521770065441],
                [-8.750918403906482, 40.590621294924347],
                [-8.750910116547125, 40.589720819641045],
                [-8.750901829562133, 40.588820344215534],
                [-8.750893542951454, 40.587919868647752],
                [-8.752033204544309, 40.583411166397646],
                [-8.753197661499916, 40.581603879860246],
                [-8.754353725869473, 40.57889610509153],
                [-8.75434539587552, 40.577995628559734],
                [-8.755484665289874, 40.573486887474438],
                [-8.755476321724164, 40.572586410290121],
                [-8.755467978535284, 40.571685932963568],
                [-8.756590357693439, 40.565376221142664],
                [-8.762418304404409, 40.557239906986382],
                [-8.763590483188581, 40.556332991533104],
                [-8.764762630341858, 40.555426064281399],
                [-8.769442378409211, 40.550897759154118],
                [-8.769433854528339, 40.54999728085275],
                [-8.769425331032414, 40.549096802409125],
                [-8.769416807921365, 40.548196323823198],
                [-8.769408285195214, 40.547295845094986],
                [-8.769357156919476, 40.541892969737987],
                [-8.769348636886896, 40.540992490013835],
                [-8.771649464650025, 40.534676107175152],
                [-8.772821128332581, 40.533769098456425],
                [-8.773975602063665, 40.531061117167987],
                [-8.775129984121774, 40.528353123787795],
                [-8.776267059204129, 40.523844156084856],
                [-8.776258452126587, 40.522943674754288],
                [-8.776249845437658, 40.522043193281412],
                [-8.77624123913729, 40.521142711666272],
                [-8.776232633225511, 40.520242229908845],
                [-8.775069839672369, 40.522049755013789],
                [-8.77041804549169, 40.529279737520909],
                [-8.766920063311559, 40.533801619258007],
                [-8.765756788660873, 40.535609050068118],
                [-8.76576525898744, 40.536509531260442],
                [-8.765773729696511, 40.537410012310531],
                [-8.765782200788063, 40.538310493218326],
                [-8.765790672262121, 40.53921097398387],
                [-8.768219328229039, 40.546401861204551],
                [-8.765926267885765, 40.553618646885361],
                [-8.757720902999658, 40.559966972019588],
                [-8.756556935968296, 40.561774307236448],
                [-8.755392906789433, 40.563581630624071],
                [-8.75194192293873, 40.573505920140633],
                [-8.750785851066244, 40.576213673324418],
                [-8.749629687197741, 40.578921414353623],
                [-8.748473431315002, 40.581629143224973],
                [-8.748481683633907, 40.582529620186762],
                [-8.748489936325575, 40.583430097006293],
                [-8.747350036028299, 40.587938766016983],
                [-8.746201761522808, 40.591546945585854],
                [-8.743872068629891, 40.595161364781568],
                [-8.741542126634299, 40.598775736539999],
                [-8.74155029094031, 40.599676211986313],
                [-8.743954030537271, 40.604166114593177],
                [-8.738046746436336, 40.604197205193486],
                [-8.736865288513012, 40.604203387061865],
                [-8.735708093065234, 40.606910983134973],
                [-8.735716181409854, 40.607811458280153],
                [-8.735724270119855, 40.608711933283161],
                [-8.738127952512022, 40.61320195060938],
                [-8.74052380400725, 40.616791439319584],
                [-8.740531959829017, 40.617691912118403],
                [-8.741746344972144, 40.621287580037539],
                [-8.739390970057825, 40.622200483938606],
                [-8.73824983043419, 40.62670904207225],
                [-8.73707608820208, 40.627615700647667],
                [-8.735902314225083, 40.628522347377555],
                [-8.732380801810216, 40.631242216482988],
                [-8.731231007159963, 40.634850231214848],
                [-8.73007306955494, 40.637557761841421],
                [-8.730081090930002, 40.638458233122208],
                [-8.73008911266755, 40.639358704260822],
                [-8.730097134767524, 40.640259175257306],
                [-8.724210485372565, 40.64299099423873],
                [-8.723036268957996, 40.643897510885708],
                [-8.721909504550354, 40.650206842452683],
                [-8.718370553607585, 40.651125344509978],
                [-8.713649198086975, 40.652049688768322],
                [-8.708974164161155, 40.658376672253986],
                [-8.705419209378709, 40.657493836578389],
                [-8.700666695356331, 40.654815762167708],
                [-8.699461494160209, 40.65212014634001],
                [-8.699408205994724, 40.645816825076963],
                [-8.695831353729279, 40.642232260104372],
                [-8.691065313129201, 40.6377528195938],
                [-8.686285047638028, 40.631472216571098],
                [-8.686277616551241, 40.630571737273414],
                [-8.683854566695551, 40.62337919352084],
                [-8.683847170368436, 40.622478712588453],
                [-8.681424682792271, 40.61528610419122],
                [-8.682576839622673, 40.611678557745634],
                [-8.683743656867934, 40.609871964627999],
                [-8.684895599002322, 40.60626439309052],
                [-8.688395397811854, 40.60084450564694],
                [-8.689554406050586, 40.598137368759524],
                [-8.689546939827553, 40.597236884746579],
                [-8.689539473941783, 40.59633640059171],
                [-8.689532008393254, 40.595435916294846],
                [-8.688313451102106, 40.590939176405605],
                [-8.68589166229823, 40.583746618153548],
                [-8.6858842489825, 40.582846131331564],
                [-8.68587683600162, 40.581945644367657],
                [-8.685869423355536, 40.58104515726184],
                [-8.684658778082618, 40.577448852231299],
                [-8.67987613740832, 40.570267397147902],
                [-8.681049665147462, 40.569361312379918],
                [-8.681042320492528, 40.568460822575787],
                [-8.68103497616929, 40.567560332629718],
                [-8.681020288517892, 40.565759352311922],
                [-8.681012945189684, 40.564858861940131],
                [-8.675036428955083, 40.555881791164552],
                [-8.673855807730506, 40.555887323122562],
                [-8.672675186178767, 40.555892843016707],
                [-8.677507093459006, 40.569378060958201],
                [-8.679920119317881, 40.575670333201899],
                [-8.683529444192327, 40.583757898200282],
                [-8.683536826165955, 40.584658385236764],
                [-8.685958397210458, 40.591850993163348],
                [-8.686039998955717, 40.601756324782478],
                [-8.684865977662938, 40.602662458432476],
                [-8.680176918159551, 40.607187358352093],
                [-8.677835807739095, 40.609899979081753],
                [-8.677843120093002, 40.610800462886857],
                [-8.679068682674203, 40.616197782785534],
                [-8.679076013205311, 40.617098265420758],
                [-8.679083344067628, 40.617998747914065],
                [-8.679090675261129, 40.618899230265406],
                [-8.679098006785843, 40.619799712474823],
                [-8.670861892187865, 40.624340938210658],
                [-8.669680065563931, 40.624346435098893],
                [-8.668498238614433, 40.624351919894217],
                [-8.66731641134006, 40.624357392596636],
                [-8.664995619031027, 40.629771200286172],
                [-8.665002764029389, 40.630671682883396],
                [-8.668577353906647, 40.63425722433076],
                [-8.667402530382788, 40.635163180478408],
                [-8.668591742730326, 40.63605818692885],
                [-8.6709991739181, 40.641450083039544],
                [-8.6674671503149, 40.643267507978855],
                [-8.663934934461116, 40.645084825515724],
                [-8.662759859393294, 40.645990734317486],
                [-8.66166290835797, 40.656801907983443],
                [-8.672471337551549, 40.677463648565279],
                [-8.667761862804866, 40.680187076670769],
                [-8.665403399671057, 40.681098481833516],
                [-8.664227717661547, 40.682004403766896],
                [-8.661883374784006, 40.684716686482588],
                [-8.657187065861951, 40.68924063437828],
                [-8.657194120743696, 40.690141108805072],
                [-8.658391253954768, 40.691936680644353],
                [-8.667898622172299, 40.697296064180371],
                [-8.667927428587369, 40.700897949757476],
                [-8.667934631004995, 40.701798420796848],
                [-8.667941833748234, 40.702698891694268],
                [-8.671520470413249, 40.706284272113017],
                [-8.671527722593655, 40.707184741779457],
                [-8.672740087773324, 40.710781093313727],
                [-8.671563988413846, 40.711687087981787],
                [-8.670387857173811, 40.712593070726484],
                [-8.665675837636853, 40.71531641333528],
                [-8.660963433191355, 40.718039564699041],
                [-8.658603545977217, 40.718950833842406],
                [-8.653883577314318, 40.720773228142242],
                [-8.649142486432265, 40.71989401851377],
                [-8.647958967396788, 40.719899303299819],
                [-8.646775448047654, 40.719904575952235],
                [-8.645591928385583, 40.719909836470997],
                [-8.638504425337647, 40.721742089171336],
                [-8.637320871609266, 40.721747265081177],
                [-8.636137317573665, 40.721752428856561],
                [-8.634953763231564, 40.721757580497467],
                [-8.627852430783184, 40.721788235517884],
                [-8.624288521776542, 40.720002450944961],
                [-8.624281902873756, 40.719101976598886],
                [-8.621921470535927, 40.720012498766671],
                [-8.619560973514929, 40.720922972890392],
                [-8.616023360819957, 40.722738831477621],
                [-8.613662686293575, 40.723649185555807],
                [-8.611308392319517, 40.725459966794475],
                [-8.610131197477545, 40.726365339461871],
                [-8.610137627339888, 40.727265814554535],
                [-8.61017621261945, 40.732668662133214],
                [-8.617291776130072, 40.734440034213407],
                [-8.618475558338613, 40.734435062393608],
                [-8.622013719933429, 40.73261912916373],
                [-8.624374594749467, 40.731708604538554],
                [-8.626735404840071, 40.730798031852693],
                [-8.627905780409579, 40.72899201908097],
                [-8.629062723151169, 40.725385048958813],
                [-8.632606848877675, 40.724469265344119],
                [-8.638524859831216, 40.724443504699458],
                [-8.639715289165816, 40.725338787558769],
                [-8.645661005030584, 40.728914542882308],
                [-8.646851609536881, 40.729809750396704],
                [-8.648035304347722, 40.729804475912516],
                [-8.650402693027122, 40.729793890530665],
                [-8.651586386894282, 40.729788579632967],
                [-8.652770080445395, 40.729783256597436],
                [-8.657511920723534, 40.730662311117207],
                [-8.659886437713892, 40.731551998747626],
                [-8.662261017566156, 40.732441636999667],
                [-8.663444756108481, 40.73243620420957],
                [-8.670525445301328, 40.729701954532466],
                [-8.671723655446382, 40.731497369100261],
                [-8.672914652748867, 40.732392304889984],
                [-8.67530405332368, 40.735082603316584],
                [-8.675311363881614, 40.735983067914127],
                [-8.6753186747701, 40.736883532369625],
                [-8.676517144200739, 40.738678893306925],
                [-8.677723022941466, 40.741374704224107],
                [-8.678929000122906, 40.744070500662126],
                [-8.678958449175306, 40.747672350404514],
                [-8.677781790648513, 40.748578406257977],
                [-8.676619764152976, 40.751285374333058],
                [-8.677840579618309, 40.755782099201262],
                [-8.677847929735018, 40.756682560179961],
                [-8.677855280184104, 40.757583021016636],
                [-8.677862630965576, 40.758483481711274],
                [-8.677869982079477, 40.75938394226381],
                [-8.677877333525835, 40.760284402674351],
                [-8.677884685304626, 40.761184862942805],
                [-8.677892037415871, 40.762085323069229],
                [-8.679105774363865, 40.76568156502497],
                [-8.679113144121567, 40.766582024264423],
                [-8.679120514212563, 40.767482483361817],
                [-8.679127884636888, 40.768382942317153],
                [-8.682718098961971, 40.772868366397375],
                [-8.682725519355273, 40.773768823967821],
                [-8.682755204284682, 40.777370652828765],
                [-8.681592891502943, 40.780077659417081],
                [-8.679245856770224, 40.782790266281829],
                [-8.678068587871376, 40.783696323486389],
                [-8.676891286976605, 40.784602368741488],
                [-8.675713954084438, 40.785508402045927],
                [-8.674536589193446, 40.786414423398611],
                [-8.673359192302081, 40.787320432798346],
                [-8.67218176340889, 40.788226430244023],
                [-8.667471727788309, 40.791850300462947],
                [-8.662725401595516, 40.790971692233505],
                [-8.661540624000152, 40.790977124019776],
                [-8.660398589088512, 40.796385289781007],
                [-8.659220823764645, 40.797291155627306],
                [-8.658043026422616, 40.79819700950614],
                [-8.65686519706095, 40.799102851416329],
                [-8.655687335678172, 40.800008681356722],
                [-8.654509442272781, 40.800914499326225],
                [-8.650968570798254, 40.80273142384366],
                [-8.649790564985699, 40.803637193892214],
                [-8.648612527144603, 40.804542951964486],
                [-8.646263291678089, 40.807254889830048],
                [-8.645085142038637, 40.808160611990758],
                [-8.643906960363266, 40.809066322170167],
                [-8.642728746650473, 40.809972020367169],
                [-8.641550500898783, 40.810877706580619],
                [-8.640372223106741, 40.811783380809338],
                [-8.636837197473573, 40.814500331575672],
                [-8.632103138925805, 40.81542139055562],
                [-8.628540784819934, 40.814536254857764],
                [-8.627355581794337, 40.81454133805898],
                [-8.626170378466409, 40.814546409086105],
                [-8.630971778363808, 40.822630173391467],
                [-8.633362768565576, 40.825321289152285],
                [-8.634548162399188, 40.825316143132213],
                [-8.635733555925942, 40.825310984933495],
                [-8.636918949145146, 40.825305814556152],
                [-8.638097511689981, 40.82440017602935],
                [-8.64520284021062, 40.823468370808939],
                [-8.646409026638922, 40.826164467780806],
                [-8.648807742237508, 40.829755711237567],
                [-8.647629232472935, 40.830661458032537],
                [-8.646457635735434, 40.832467646517728],
                [-8.644114252630317, 40.836079987234903],
                [-8.64294936541917, 40.838786592645604],
                [-8.644134997335671, 40.838781346713922],
                [-8.659576681787568, 40.842313842733034],
                [-8.65724786204426, 40.847727341202976],
                [-8.656069152307705, 40.848633172638664],
                [-8.654890410470218, 40.849538992083104],
                [-8.65489747421846, 40.850439441747284],
                [-8.65490453828636, 40.851339891269475],
                [-8.654911602673893, 40.852240340649644],
                [-8.654918667381109, 40.853140789887746],
                [-8.654925732408035, 40.854041238983882],
                [-8.654932797754643, 40.854941687937966],
                [-8.656161210532575, 40.860339006838437],
                [-8.657347224195583, 40.860333622803587],
                [-8.659612311884977, 40.84681609191481],
                [-8.660790941053094, 40.845910224483404],
                [-8.661955222221273, 40.843203445934883],
                [-8.663119409704231, 40.840496654950961],
                [-8.66311223716629, 40.839596204918386],
                [-8.663105064952864, 40.838695754743753],
                [-8.663097893063929, 40.837795304427075],
                [-8.663090721499515, 40.836894853968381],
                [-8.663083550259545, 40.835994403367607],
                [-8.663076379344041, 40.835093952624796],
                [-8.663069208752978, 40.834193501739925],
                [-8.663026192018867, 40.828790793447816],
                [-8.664204457740905, 40.827884890569209],
                [-8.665375491658668, 40.826078523894665],
                [-8.666546462424867, 40.824272145163498],
                [-8.667702910041848, 40.820664849869694],
                [-8.667695680529661, 40.81976439740243],
                [-8.667666765751314, 40.816162586112959],
                [-8.668830259394387, 40.813455729213146],
                [-8.669993659526858, 40.81074885990359],
                [-8.671149693180578, 40.807141524253311],
                [-8.672305603634189, 40.803534175554788],
                [-8.673461390920899, 40.79992681381249],
                [-8.673454088873108, 40.799026358949149],
                [-8.673446787155587, 40.798125903943763],
                [-8.672232744910401, 40.794529624461511],
                [-8.673395684379805, 40.791822714928237],
                [-8.675743272452859, 40.789110227766606],
                [-8.679282740572749, 40.787292547562139],
                [-8.680460055800445, 40.78638647823368],
                [-8.681637339027947, 40.78548039695616],
                [-8.68635362370634, 40.782756407991897],
                [-8.687530762613298, 40.781850266948879],
                [-8.689877425740185, 40.779137493536112],
                [-8.691046918996348, 40.777330861103508],
                [-8.692208800311825, 40.774623760818486],
                [-8.693370588415503, 40.771916648184749],
                [-8.693363024800982, 40.771016191948355],
                [-8.694517126520141, 40.767408610101363],
                [-8.69569388506123, 40.766502385884351],
                [-8.696870611634413, 40.765596149736545],
                [-8.69804730624119, 40.764689901659096],
                [-8.699208688341105, 40.761982728304609],
                [-8.700377632363487, 40.760175999608187],
                [-8.700369977323261, 40.759275542619996],
                [-8.700362322629156, 40.758375085489632],
                [-8.700354668281223, 40.757474628217153],
                [-8.700347014279409, 40.756574170802523],
                [-8.700339360623717, 40.75567371324577],
                [-8.700331707314094, 40.754773255546844],
                [-8.700324054350565, 40.753872797705803],
                [-8.700316401733085, 40.752972339722596],
                [-8.700308749461644, 40.752071881597317],
                [-8.700301097536199, 40.751171423329879],
                [-8.699086493744874, 40.747575401048387],
                [-8.697872022881496, 40.743979362881277],
                [-8.69786440600042, 40.743078902968058],
                [-8.696665284795833, 40.741283769355682],
                [-8.695451062348992, 40.737687700182647],
                [-8.696612092819201, 40.734980542715498],
                [-8.69660449533961, 40.734080081198456],
                [-8.697757805819258, 40.730472449261029],
                [-8.697750194102307, 40.729571987216119],
                [-8.69774258272952, 40.728671525029114],
                [-8.697734971700818, 40.727771062699972],
                [-8.69772736101625, 40.726870600228729],
                [-8.69888049072042, 40.723262953800798],
                [-8.698872865807171, 40.722362490802062],
                [-8.697658880336565, 40.718766431593068],
                [-8.700018219385973, 40.717854367520133],
                [-8.701194037280993, 40.716948085746779],
                [-8.702369823287695, 40.716041792067116],
                [-8.703545577407505, 40.715135486482275],
                [-8.707080381169273, 40.713316961578755],
                [-8.709423869755502, 40.710603780020506],
                [-8.711767168828631, 40.707890550904551],
                [-8.71411027842195, 40.705177274244541],
                [-8.716453198568733, 40.702463950054046],
                [-8.717620651880452, 40.700657038405872],
                [-8.718788042535831, 40.698850114820715],
                [-8.719947468918042, 40.696142715538109],
                [-8.71993956765052, 40.695242251633111],
                [-8.719931666740134, 40.694341787585948],
                [-8.719923766186863, 40.693441323396613],
                [-8.719915865990702, 40.69254085906509],
                [-8.719907966151629, 40.691640394591424],
                [-8.719900066669647, 40.690739929975564],
                [-8.718677665229375, 40.686243610528422],
                [-8.718669783808437, 40.685343144869883],
                [-8.718661902743744, 40.684442679069178],
                [-8.717447567808497, 40.680846806954861],
                [-8.71743970443937, 40.679946340254084],
                [-8.718590989188446, 40.676338480465667],
                [-8.719765830089559, 40.675432009754523],
                [-8.722107492266334, 40.672718565624223],
                [-8.723274282803585, 40.670911592162305],
                [-8.72442510278322, 40.667303671825515],
                [-8.725591737855087, 40.665496674345611],
                [-8.726750326568354, 40.662789197076229],
                [-8.729099282461338, 40.660976078361941],
                [-8.732630539328472, 40.659156778931873],
                [-8.733804889723245, 40.658250166138096],
                [-8.734979208324253, 40.657343541483847],
                [-8.736153495132946, 40.656436904970313],
                [-8.737319626519758, 40.654629789184945],
                [-8.738485695432027, 40.652822661507102],
                [-8.738477557010032, 40.651922193862426],
                [-8.738469418955784, 40.651021726075548],
                [-8.739619089779309, 40.647413650153197],
                [-8.740801308774206, 40.647407434698408],
                [-8.745521949513293, 40.646481984540614],
                [-8.746704150767842, 40.64647570877306],
                [-8.74788635164971, 40.646469420903763],
                [-8.74906855215818, 40.646463120932673],
                [-8.750250752292564, 40.646456808859824],
                [-8.756153373175035, 40.645524601308871],
                [-8.757369117596117, 40.649120077809741],
                [-8.756195247723182, 40.650026928189561],
                [-8.755038067512652, 40.652734696601151],
                [-8.753872448821639, 40.654541988194545],
                [-8.752715098695806, 40.657249732472891],
                [-8.751557656206687, 40.659957464566801],
                [-8.750400121335916, 40.662665184472964],
                [-8.749242494065196, 40.665372892188067],
                [-8.748084774376157, 40.668080587708793],
                [-8.746926962250482, 40.670788271031768],
                [-8.746935219749849, 40.671688734308873],
                [-8.749341963581205, 40.676178447591582],
                [-8.748167514050428, 40.677085216357725],
                [-8.747001293181661, 40.678892435403696],
                [-8.745835009780114, 40.680699642559532],
                [-8.744685125248989, 40.684307761328753],
                [-8.743535118957807, 40.687915867286918],
                [-8.743543335788898, 40.68881632845499],
                [-8.742393193266849, 40.692424421226001],
                [-8.742401396030729, 40.693324881880102],
                [-8.741251117233389, 40.696932961458792],
                [-8.740100716566557, 40.70054102821252],
                [-8.740108890806255, 40.701441487979864],
                [-8.73895835378136, 40.705049541531487],
                [-8.738966513934251, 40.705950000783815],
                [-8.737815840506842, 40.709558041128147],
                [-8.73665691387656, 40.712265610127965],
                [-8.735506010930935, 40.715873625164051],
                [-8.734346884039448, 40.718581169452875],
                [-8.733187664407515, 40.721288701496817],
                [-8.73203642422162, 40.724896678727518],
                [-8.730877004196524, 40.727604186038626],
                [-8.729725534221814, 40.731212137920878],
                [-8.72856591371254, 40.733919620484421],
                [-8.727414213838584, 40.737527547001967],
                [-8.727422227677081, 40.738428003076073],
                [-8.729797936239962, 40.739316242957202],
                [-8.735725292063551, 40.740185944789474],
                [-8.736909152831332, 40.740179757649983],
                [-8.741652798692451, 40.741055340985312],
                [-8.746396566691679, 40.741930728329194],
                [-8.747580456045883, 40.741924431517283],
                [-8.752324360605584, 40.742799574082227],
                [-8.753508264043026, 40.742793216357931],
                [-8.758252305099946, 40.74366811412014],
                [-8.759436222603076, 40.743661695479837],
                [-8.764180400093885, 40.744536348415394],
                [-8.765364331645218, 40.744529868855558],
                [-8.770108645506559, 40.745404276940612],
                [-8.771292591088566, 40.745397736457704],
                [-8.776037041257128, 40.746271899668407],
                [-8.777221000852254, 40.746265298258891],
                [-8.781965587264661, 40.747139216571419],
                [-8.783149560855422, 40.74713255423169],
                [-8.787894283448317, 40.748006227622177],
                [-8.792639127794727, 40.748879704859135],
                [-8.79382312972713, 40.748872932793461],
                [-8.795007131256545, 40.748866148582763],
                [-8.79619113238223, 40.748859352227143],
                [-8.797366172756005, 40.747952101385678],
                [-8.798523230591941, 40.745243953723516],
                [-8.798514255899633, 40.744343511027708],
                [-8.79850528161311, 40.743443068189315],
                [-8.799653228785251, 40.739834464776628],
                [-8.799644240566398, 40.738934021441089],
                [-8.799635252753916, 40.738033577962945],
                [-8.800783049667011, 40.734424961146367],
                [-8.800774047929554, 40.733524517171411],
                [-8.800765046599054, 40.732624073053884],
                [-8.800756045675513, 40.731723628793766],
                [-8.801903678062127, 40.728114998225152],
                [-8.803051188947228, 40.724506354971666],
                [-8.803042159788095, 40.723605909861497],
                [-8.803033131037168, 40.722705464608751],
                [-8.803024102694421, 40.72180501921342],
                [-8.803015074759804, 40.720904573675497],
                [-8.803006047233337, 40.720004127994997],
                [-8.802997020114978, 40.719103682171983],
                [-8.802987993404718, 40.718203236206364],
                [-8.802978967102515, 40.717302790098159],
                [-8.802969941208364, 40.716402343847399],
                [-8.802960915722263, 40.715501897454061],
                [-8.804108162036458, 40.711893237987695],
                [-8.806447636612198, 40.709178116875911],
                [-8.808786921997887, 40.706462948584466],
                [-8.809951935710352, 40.704655123334547],
                [-8.811098625565569, 40.701046392111863],
                [-8.811089495503923, 40.700145944821593],
                [-8.811080365854988, 40.69924549738878],
                [-8.811062107795067, 40.697444602095267],
                [-8.81105297938408, 40.696544154234644],
                [-8.812199476614291, 40.69293540860744],
                [-8.812190334342828, 40.692034960253416],
                [-8.813336696115149, 40.688426201631337],
                [-8.814482936735335, 40.684817430369534],
                [-8.81562905623608, 40.681208646472392],
                [-8.815619871593242, 40.680308196925438],
                [-8.815610687365503, 40.679407747235913],
                [-8.815583137172718, 40.676706397311648],
                [-8.815573954605181, 40.675805947051693],
                [-8.814372919444793, 40.674012030591769],
                [-8.811989308878463, 40.672225060388989],
                [-8.810770203191266, 40.668630199831405],
                [-8.810761087973194, 40.667729747408131],
                [-8.811907128780705, 40.664120990553975],
                [-8.811897999721827, 40.663220537637187],
                [-8.811888871075503, 40.662320084577843],
                [-8.811879742841711, 40.661419631375935],
                [-8.811870615020425, 40.66051917803145],
                [-8.811861487611619, 40.65961872454438],
                [-8.811852360615266, 40.65871827091474],
                [-8.811843234031368, 40.657817817142536],
                [-8.811834107859873, 40.656917363227777],
                [-8.811824982100756, 40.656016909170418],
                [-8.811815856754043, 40.655116454970518],
                [-8.811806731819681, 40.654216000628068],
                [-8.811797607297647, 40.653315546143006],
                [-8.811788483187941, 40.652415091515415],
                [-8.811779359490512, 40.651514636745205],
                [-8.811770236205357, 40.650614181832516],
                [-8.811761113332429, 40.649713726777193],
                [-8.81175199087175, 40.648813271579343],
                [-8.811742868823297, 40.647912816238929],
                [-8.811733747186993, 40.647012360755944],
                [-8.811724625962889, 40.64611190513039],
                [-8.811715505150909, 40.645211449362286],
                [-8.811706384751053, 40.644310993451597],
                [-8.811697264763295, 40.643410537398417],
                [-8.811688145187635, 40.64251008120263],
                [-8.811679026024018, 40.641609624864294],
                [-8.811669907272455, 40.640709168383417],
                [-8.81166078893291, 40.639808711759962],
                [-8.811651671005334, 40.638908254994],
                [-8.811642553489758, 40.63800779808544],
                [-8.811633436386126, 40.637107341034337],
                [-8.811624319694442, 40.6362068838407],
                [-8.81161520341465, 40.635306426504478],
                [-8.811606087546778, 40.6344059690257],
                [-8.811596972090751, 40.633505511404394],
                [-8.811587857046566, 40.632605053640546],
                [-8.811578742414223, 40.631704595734156],
                [-8.811569628193704, 40.630804137685203],
                [-8.811560514384947, 40.629903679493715],
                [-8.811551400987961, 40.629003221159657],
                [-8.811542288002739, 40.628102762683056],
                [-8.81153317542921, 40.627202304063943],
                [-8.811524063267397, 40.626301845302272],
                [-8.811514951517276, 40.625401386398053],
                [-8.811505840178794, 40.624500927351285],
                [-8.811496729251951, 40.623600468161996],
                [-8.811487618736724, 40.622700008830144],
                [-8.811478508633112, 40.621799549355764],
                [-8.811460289660577, 40.619998629979392],
                [-8.811451180791632, 40.619098170077393],
                [-8.811442072334174, 40.618197710032867],
                [-8.814959666881023, 40.615475454825706],
                [-8.816141305204926, 40.615468472576715],
                [-8.817322943114517, 40.615461478239602],
                [-8.818504580609137, 40.615454471814374],
                [-8.819686217687991, 40.615447453301094],
                [-8.822040241031402, 40.614532921384573],
                [-8.823203331401997, 40.612724949596405],
                [-8.823194067232084, 40.611824490765692],
                [-8.823184803480661, 40.610924031792422],
                [-8.823175540147718, 40.61002357267656],
                [-8.823166277233238, 40.6091231134181],
                [-8.823119968937105, 40.604620814986994],
                [-8.823110708532974, 40.603720354873026],
                [-8.823101448547146, 40.602819894616459],
                [-8.823092188979626, 40.601919434217329],
                [-8.823082929830386, 40.601018973675615],
                [-8.823073671099378, 40.600118512991337],
                [-8.823064412786623, 40.599218052164431],
                [-8.824208670343459, 40.595609145476388],
                [-8.824199398276003, 40.594708684159748],
                [-8.825343521180924, 40.59109976455067],
                [-8.826487523639333, 40.58749083237209],
                [-8.827631405683777, 40.583881887628323],
                [-8.827622091550712, 40.582981425129695],
                [-8.827612777838318, 40.582080962488511],
                [-8.828756511200556, 40.57847200449239],
                [-8.82874718375944, 40.577571541362822],
                [-8.829890782639454, 40.573962570465511],
                [-8.831043616942889, 40.571254050837283],
                [-8.832205730371484, 40.569445983088904],
                [-8.832196359668133, 40.568545519209238],
                [-8.832186989387971, 40.567645055186958],
                [-8.832177619530977, 40.566744591022086],
                [-8.832168250097149, 40.565844126714637],
                [-8.832158881086436, 40.564943662264611],
                [-8.832149512498866, 40.564043197671928],
                [-8.832140144334359, 40.563142732936662],
                [-8.832130776592942, 40.562242268058803],
                [-8.83212140927459, 40.56134180303836],
                [-8.832112042379226, 40.560441337875311],
                [-8.832083944231142, 40.557739941530656],
                [-8.833227041063783, 40.554130929549054],
                [-8.834379411611481, 40.551422371312242],
                [-8.835522282289228, 40.547813334609664],
                [-8.836674455383156, 40.545104752204736],
                [-8.836665032877395, 40.544204285380836],
                [-8.837807663408379, 40.540595223630213],
                [-8.837798227228067, 40.539694756320699],
                [-8.837788791473823, 40.538794288868573],
                [-8.838931273791415, 40.535185213915007],
                [-8.840073636127393, 40.531576126449011],
                [-8.841215878514117, 40.527967026474855],
                [-8.842358000984008, 40.524357913996937],
                [-8.842348509314592, 40.523457445033415],
                [-8.842339018073687, 40.522556975927301],
                [-8.843480992515985, 40.518947850267281],
                [-8.84347148763297, 40.518047380677189],
                [-8.844613328168618, 40.514438242181761],
                [-8.845764581908766, 40.511729561468371],
                [-8.846915744417599, 40.509020868807525],
                [-8.848057253738201, 40.505411693535862],
                [-8.849198643341374, 40.501802505786792],
                [-8.850339913259486, 40.498193305564691],
                [-8.850330323632599, 40.497292834076468],
                [-8.850320734438625, 40.496392362445597],
                [-8.851461856637224, 40.492783149076928],
                [-8.845554955111142, 40.491919182545807],
                [-8.840827647889775, 40.491047696045165],
                [-8.837279892867867, 40.490168834705159],
                [-8.832552811008391, 40.48929700752106],
                [-8.82782584891074, 40.488424985836126],
                [-8.826646444557685, 40.488432069415019],
                [-8.82191961635098, 40.487559804887312],
                [-8.820740225673495, 40.48756682807285],
                [-8.816013531420278, 40.486694320725931],
                [-8.814834154435641, 40.486701283521654],
                [-8.813654777039719, 40.486708234283732],
                [-8.808928230923913, 40.485835435788452],
                [-8.807748867241704, 40.485842326164523],
                [-8.806569503152486, 40.485849204507289],
                [-8.801843105266867, 40.484976114893961],
              ],
            ],
          },
        },
      ],
    }

    return (
      <GeoJSON
        data={geojsonFeature}
        style={() => {
          return {
            color: '#f8971b',
            weight: 1,
            fillOpacity: 0.2,
          }
        }}
      />
    )
  }

  public render() {
    return (
      <>
        {this.buildAveiroArea()}
        {this.buildPollutionMarkers()}
        {this.buildSelectedLocation()}
        {this.buildObstaclesPolygons()}
        {this.drawObstacleLocation()}
      </>
    )
  }
}

const actionCreators = {
  setSidePanelContent,
  setSidePanelTitle,
  setSidePanelVisibility,
}

export default connect(null, actionCreators)(Pollution)
